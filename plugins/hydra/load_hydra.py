
import sqlite3
import os

# 未支持 
services = [ ('snmp', 161)]

if not os.path.exists('out/hydra'):
    os.mkdir('out/hydra')

conn = sqlite3.connect("report/data.db")
cur = conn.cursor()
with open('out/hydra/hydra.target', 'w') as f:
    for service in services:
        try:
            cur.execute("select * from nmap where p{} != ''".format(service[1]))
            targets = cur.fetchall()
            # with open('out/hydra/{}.target'.format(service[0]), 'w') as f:
            for target in targets:
                print(service[0] + " " + target[0])
                f.write( service[0] + " " + target[0] + "\n")
        except Exception as e:
            print(e)
cur.close()
