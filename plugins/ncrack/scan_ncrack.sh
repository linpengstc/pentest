# snmp
ncrack_out="out/ncrack"
hydra_data="data/hydra"

rm -rf out/ncrack/*.result

cat $1|while read line;do
    service=`echo $line | awk {'print $1'}`
    addr=`echo $line | awk {'print $2'}`
    if [ $service = 'ftp' ];then
        cat $hydra_data/ftp.nm  $hydra_data/common.nm > $ncrack_out/ftp.nm
        cat $hydra_data/ftp.pwd  $hydra_data/common.pwd > $ncrack_out/ftp.pwd
        echo "ncrack -U $ncrack_out/ftp.nm -P $ncrack_out/ftp.pwd -oN $ncrack_out/ftp.result --append-output -f ftp://$addr -d10 -T4"
        ncrack -U $ncrack_out/ftp.nm -P $ncrack_out/ftp.pwd -oN $ncrack_out/ftp.result --append-output -f ftp://$addr -d10 -T4
    elif [ $service = 'redis' ];then
        echo "ncrack -P $hydra_data/common.pwd -oN $ncrack_out/redis.result  --append-output -f redis://$addr -d10 -T4"
        ncrack -P $hydra_data/common.pwd -oN $ncrack_out/redis.result  --append-output -f redis://$addr -d10 -T4
    elif [ $service = 'telnet' ];then
        # ncrack会持续请求telnet很久除非设置超时时间
        echo "ncrack -U $hydra_data/common.nm -P $hydra_data/common.pwd -oN $ncrack_out/$service.result  --append-output -f $service://$addr,to=180 -d10 -T4"
        ncrack -U $hydra_data/common.nm -P $hydra_data/common.pwd -oN $ncrack_out/$service.result  --append-output -f $service://$addr,to=180 -d10 -T4
    else
        echo "ncrack -U $hydra_data/common.nm -P $hydra_data/common.pwd -oN $ncrack_out/$service.result  --append-output -f $service://$addr -d10 -T4 -to 600"
        ncrack -U $hydra_data/common.nm -P $hydra_data/common.pwd -oN $ncrack_out/$service.result  --append-output -f $service://$addr,to=600s -d10 -T4
    fi
done

cat $ncrack_out/*.result > $ncrack_out/final.result