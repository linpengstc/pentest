# -*- coding:utf-8 -*-
import sqlite3


def save_into_sqlite3():
    conn = sqlite3.connect("report/data.db")
    cur = conn.cursor()
    cur.execute('DROP TABLE IF EXISTS domain_ip')
    cur.execute("create table domain_ip (ip varchar(50), domain varchar(50), pdomain varchar(50), cfield varchar(50))")
    with open("out/domain_ip.target") as f:
        for l in f:
            l = l.strip()
            vals = l.split(" ")
            for v in vals[1::]:
                if v == '':
                    continue
            for ip in v.split(","):
                cur.execute("insert into domain_ip(ip, domain, pdomain, cfield) values(?,?,?,?)", (ip, vals[0], ".".join(vals[0].split(".")[1::]), ".".join(ip.split('.')[0:3]) + ".0/24" ))
    conn.commit()
    conn.close()


save_into_sqlite3()

        
    
        
