# snmp
hydra_out="out/hydra"
hydra_data="data/hydra"

rm -rf out/hydra/*.result

cat $1|while read line;do
    service=`echo $line | awk {'print $1'}`
    addr=`echo $line | awk {'print $2'}`
    if [ $service = 'snmp' ] ; then
        echo "hydra -V -w 10  -t 64 -e ns -f -P $hydra_data/snmp.pwd -o $hydra_out/snmp.result $addr snmp"
        hydra -V -w 10  -t 64 -f -P $hydra_data/snmp.pwd -o $hydra_out/snmp.result $addr snmp
    elif [ $service = 'ftp' ];then
        cat $hydra_data/ftp.nm  $hydra_data/common.nm > $hydra_out/ftp.nm
        cat $hydra_data/ftp.pwd  $hydra_data/common.pwd > $hydra_out/ftp.pwd
        echo "hydra -V -w 10 -t 64 -e ns -f -L $hydra_out/ftp.nm -P $hydra_out/ftp.pwd -o $hydra_out/ftp.result $addr ftp"
        hydra -V -w 10 -t 64 -f -L $hydra_out/ftp.nm -P $hydra_out/ftp.pwd -o $hydra_out/ftp.result $addr ftp
    elif [ $service = 'ssh' ];then
        echo "hydra -V -w 10 -t 64 -e ns -f -L $hydra_data/common.nm -P $hydra_data/common.pwd -o $hydra_out/ssh.result $addr ssh"
        hydra -V -w 10 -t 64 -f -L $hydra_data/common.nm -P $hydra_data/common.pwd -o $hydra_out/ssh.result $addr ssh
    elif [ $service = 'redis' ];then
        echo "hydra -V -w 10  -t 64 -e ns -f -P $hydra_data/common.pwd -o $hydra_out/redis.result $addr redis"
        hydra -V -w 10  -t 64 -f -P $hydra_data/common.pwd -o $hydra_out/redis.result $addr redis
    else
        echo "hydra -V -w 10 -t 64  -e ns -f -L $hydra_data/common.nm -P $hydra_data/common.pwd -o $hydra_out/$service.result $addr $service"
        hydra -V -w 10 -t 64 -f -L $hydra_data/common.nm -P $hydra_data/common.pwd -o $hydra_out/$service.result $addr $service
    fi
done

cat $hydra_out/*.result > $hydra_out/final.result